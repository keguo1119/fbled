#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>  
#include <sys/stat.h>  
#include <fcntl.h>
#include "fbled-gpio.h"
#include "fbled-algo-bit.h"

unsigned char NUM_2[][48] =
{
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x06,0x60,0x1C,0x18,0x18,0x18,0x30,0x0C,
0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x18,0x18,
0x18,0x18,0x0C,0x30,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,//"0",0
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,0x80,0x07,0x80,0x01,0x80,0x01,0x80,
0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,0x01,0x80,
0x01,0x80,0x01,0xC0,0x0F,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,//"1",1
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x0C,0x30,0x10,0x18,0x30,0x0C,0x38,0x0C,
0x38,0x1C,0x00,0x18,0x00,0x30,0x00,0x60,0x00,0xC0,0x01,0x80,0x02,0x00,0x04,0x00,0x18,0x04,
0x30,0x0C,0x3F,0xF8,0x3F,0xF8,0x00,0x00,0x00,0x00,0x00,0x00,//"2",2
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x07,0x80,0x08,0x70,0x10,0x38,0x38,0x18,0x18,0x18,
0x00,0x18,0x00,0x30,0x00,0xE0,0x01,0xE0,0x00,0x18,0x00,0x18,0x00,0x0C,0x10,0x0C,0x38,0x0C,
0x30,0x18,0x18,0x30,0x07,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,//"3",3
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x00,0x70,0x00,0xF0,0x00,0xF0,0x01,0x70,
0x02,0x70,0x04,0x70,0x08,0x70,0x18,0x70,0x10,0x70,0x20,0x70,0x7F,0xFE,0x00,0x70,0x00,0x70,
0x00,0x70,0x00,0x70,0x03,0xFE,0x00,0x00,0x00,0x00,0x00,0x00,//"4",4
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xF8,0x10,0x00,0x10,0x00,0x10,0x00,
0x10,0x00,0x13,0xC0,0x1C,0x30,0x10,0x18,0x00,0x0C,0x00,0x0C,0x00,0x0C,0x38,0x0C,0x38,0x0C,
0x30,0x18,0x18,0x30,0x07,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,//"5",5
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xE0,0x06,0x18,0x08,0x18,0x18,0x18,0x30,0x00,
0x30,0x00,0x30,0xC0,0x37,0x38,0x38,0x1C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,0x30,0x0C,
0x18,0x08,0x0C,0x10,0x03,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,//"6",6
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xFC,0x30,0x08,0x20,0x10,0x20,0x10,0x00,
0x20,0x00,0x40,0x00,0x40,0x00,0x80,0x01,0x80,0x01,0x80,0x03,0x00,0x03,0x00,0x03,0x00,0x03,0x80,
0x03,0x80,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//"7",7
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x0C,0x30,0x30,0x08,0x30,0x0C,0x30,0x0C,0x30,
0x0C,0x1C,0x18,0x0F,0x20,0x07,0xE0,0x18,0x70,0x30,0x18,0x20,0x0C,0x60,0x0C,0x60,0x0C,0x30,0x0C,
0x18,0x18,0x07,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,//"8",8
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x80,0x0C,0x70,0x30,0x18,0x30,0x18,0x70,0x0C,0x70,
0x0C,0x70,0x0C,0x30,0x1C,0x30,0x3C,0x1C,0x6C,0x07,0x8C,0x00,0x1C,0x00,0x18,0x00,0x18,0x18,0x30,
0x18,0x60,0x0F,0x80,0x00,0x00,0x00,0x00,0x00,0x00,//"9",9
};


int main(int argc, char **argv)
{
    int fd;
    FILE *fp;
    char buf[1204];
    struct fbled_msg msg;
    int i;


    fp = fopen("/dev/fbled", "r");
    if(fp == NULL)
    {
        printf("open /dev/fbled failed!");
        return -1;
    }

    fgets(buf, 1024, fp);
    printf("buf=%s\n", buf);

    fclose(fp);

    fd = open("/dev/fbled", O_RDWR);
    read(fd, buf, 128);
    printf("buf=%s\n", buf);

    msg.flags = FBLED_M_WR_PAGE;
    msg.len   = 48;
    for(i = 0; i < 10; i++) {
        msg.buf = NUM_2[i];
        ioctl(fd, FBLED_RDWR, &msg);
        sleep(1);
    }

    close(fd);

    return 0;

}